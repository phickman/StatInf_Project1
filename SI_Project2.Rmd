---
title: "Tooth Works"
author: "Paul Hickman"
date: '`r Sys.Date()`'
output:
  html_document:
    keep_md: no
---

# Project Question

Now in the second portion of the class, we're going to analyze the ToothGrowth data in the R datasets package.

- Load the ToothGrowth data and perform some basic exploratory data analyses 
- Provide a basic summary of the data.
- Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. (Only use the techniques from class, even if there's other approaches worth considering)
- State your conclusions and the assumptions needed for your conclusions. 

Some criteria that you will be evaluated on

- Did you  perform an exploratory data analysis of at least a single plot or table highlighting basic features of the data?
- Did the student perform some relevant confidence intervals and/or tests?
- Were the results of the tests and/or intervals interpreted in the context of the problem correctly? 
- Did the student describe the assumptions needed for their conclusions?

# Overview

The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, (orange juice or ascorbic acid (a form of vitamin C and coded as VC).

A data frame with 60 observations on 3 variables.

[,1]	len	numeric	Tooth length
[,2]	supp	factor	Supplement type (VC or OJ).
[,3]	dose	numeric	Dose in milligrams/day

https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/ToothGrowth.html

# Exploring the Data

Load the tooth growth data that will be analysed.

```{r}
library(datasets)
data("ToothGrowth")
```

Provide a basic summary of the data.

```{r}
summary(ToothGrowth)
```

There are three doseage levels for the two supplement types used.

```{r}
table(ToothGrowth$supp, ToothGrowth$dose)
```

Exploratory plots.  Add some explanation of what the plots mean and label the plots themselves.

```{r}
# make dose a factor
ToothGrowth$dose <- factor(ToothGrowth$dose)

library(ggplot2)

ggplot(ToothGrowth, aes(x = supp, y = len, fill = supp)) + geom_boxplot() + facet_wrap(~dose)
ggplot(ToothGrowth, aes(x = dose, y = len, fill = dose)) + geom_boxplot() + facet_grid(~supp)
```

Violin plots

```{r}
library(reshape2);

g <- ggplot(ToothGrowth, aes(x = supp, y = len, fill = dose))
g <- g + geom_violin(col = "black", size = 2)
g

g <- ggplot(ToothGrowth, aes(x = dose, y = len, fill = supp))
g <- g + geom_violin(col = "black", size = 2)
g
```

Provide some basic exploratory data analyses and summary of the data

# Tests

Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. (Only use the techniques from class, even if there's other approaches worth considering)

The null hypothesis is there is no difference.

Assume variance is equal

For supplements, VC & OJ, compare by dosage:

1. VC_0.5 to VC1
2. VC_0.5 to VC2
3. VC_1   to VC2
4. OJ_0.5 to OJ1
5. OJ_0.5 to OJ2
6. OJ_1   to OJ2

For dosage, 0.5, 1 & 2, compare by supplement:

7. 0.5_VC to 0.5_OJ
8. 1_VC   to 1_OJ
9. 2_VC   to 2_OJ

```{r}
# by supplement (need to compare)
vc <- ToothGrowth[ToothGrowth$supp=="VC",]
oj <- ToothGrowth[ToothGrowth$supp=="OJ",]

vc_05_1 <- vc[vc$dose %in% c(0.5,1),]
vc_05_2 <- vc[vc$dose %in% c(0.5,2),]
vc_1_2 <- vc[vc$dose %in% c(1,2),]

t.test(len ~ dose, data = vc_05_1)
t.test(len ~ dose, data = vc_05_2)
t.test(len ~ dose, data = vc_1_2)

oj_05_1 <- oj[oj$dose %in% c(0.5,1),]
oj_05_2 <- oj[oj$dose %in% c(0.5,2),]
oj_1_2 <- oj[oj$dose %in% c(1,2),]

t.test(len ~ dose, data = oj_05_1)
t.test(len ~ dose, data = oj_05_2)
t.test(len ~ dose, data = oj_1_2)

# by dose (need to compare)
tg05 <- ToothGrowth[ToothGrowth$dose == 0.5,]
tg1 <- ToothGrowth[ToothGrowth$dose == 1,]
tg2 <- ToothGrowth[ToothGrowth$dose == 2,]

t.test(len ~ supp, data = tg05)
t.test(len ~ supp, data = tg1)
t.test(len ~ supp, data = tg2)
```

# Conclusions and Assumptions

- State your conclusions and the assumptions needed for your conclusions.

# Techo
```{r}
sessionInfo()
```

# Ignore the rest

```{r}
# unused

plot(ToothGrowth)
with(ToothGrowth, plot(supp, len))

#plot(oj, col=oj$dose)
#plot(oj, col=oj$supp)
#plot(oj, col=oj$len)

require(graphics)
coplot(len ~ dose | supp, data = ToothGrowth, panel = panel.smooth)

# identify the subset of VC and OJ data
vc <- ToothGrowth[ToothGrowth$supp=="VC",]
oj <- ToothGrowth[ToothGrowth$supp=="OJ",]

boxplot(len ~ supp * dose, data=ToothGrowth, ylab="Tooth Length", main="Boxplots of Tooth Growth Data")

ggplot(ToothGrowth, aes(x = supp, y = len)) + geom_boxplot()
ggplot(ToothGrowth, aes(x = supp, y = len, fill = supp)) + geom_boxplot()
ggplot(ToothGrowth, aes(factor(dose), len)) + geom_boxplot() + facet_grid(.~supp)
ggplot(ToothGrowth, aes(factor(dose), len, fill = dose)) + geom_boxplot() + facet_grid(.~supp)

qplot(len, dose, data = ToothGrowth)

library(lattice)
xyplot(len ~ dose | supp, data = ToothGrowth)
xyplot(len ~ supp | dose, data = ToothGrowth, layout = c(3,1))

g <- ggplot(ToothGrowth, aes(x = dose, y = len, colour = supp, group = supp))
g <- g + geom_line()
g <- g + stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1, col = "black")
g <- g + facet_grid(. ~ supp)
g

g <- ggplot(ToothGrowth, aes(x = supp, y = len, colour = dose, group = dose))
g <- g + geom_line()
g <- g + stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1, col = "black")
g <- g + facet_grid(. ~ dose)
g

#ggplot (ToothGrowth, aes (x = dose, y = len, fill = supp)) + stat_binhex (bins=5, aes (alpha = ..count..)) + facet_grid (. ~ Species)

xyplot(len ~ supp, ToothGrowth, groups = ToothGrowth$dose, pch= 20)
```

