---
title: "Tooth Works"
author: "Paul Hickman"
date: '`r Sys.Date()`'
output:
  html_document:
    keep_md: no
---

# Overview

Now in the second portion of the class, we're going to analyze the ToothGrowth data in the R datasets package. 
- Load the ToothGrowth data and perform some basic exploratory data analyses 
- Provide a basic summary of the data.
- Use confidence intervals and/or hypothesis tests to compare tooth growth by supp and dose. (Only use the techniques from class, even if there's other approaches worth considering)
- State your conclusions and the assumptions needed for your conclusions. 

Some criteria that you will be evaluated on
- Did you  perform an exploratory data analysis of at least a single plot or table highlighting basic features of the data?
- Did the student perform some relevant confidence intervals and/or tests?
- Were the results of the tests and/or intervals interpreted in the context of the problem correctly? 
- Did the student describe the assumptions needed for their conclusions?

# Start

The response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, (orange juice or ascorbic acid (a form of vitamin C and coded as VC).

A data frame with 60 observations on 3 variables.

[,1]	len	numeric	Tooth length
[,2]	supp	factor	Supplement type (VC or OJ).
[,3]	dose	numeric	Dose in milligrams/day

https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/ToothGrowth.html



```{r}
data("ToothGrowth")

str(ToothGrowth)
summary(ToothGrowth)
head(ToothGrowth)
table(ToothGrowth$supp,ToothGrowth$dose)

# RR relationships between predictors
#library(kernlab)
#data(spam)
##structureOfADataAnalysis2.pdf
#plot(log10(trainSpam$capitalAve + 1) ~ trainSpam$type)
#plot(log10(trainSpam[, 1:4] + 1))
#plot(hclust(dist(t(trainSpam[,1:57]))))
#plot(hclust(dist(t(log10(trainSpam[,1:55]))))

plot(log10(ToothGrowth$len))
plot(log10(ToothGrowth$dose))

#ToothGrowth$dose <- factor(ToothGrowth$dose)

plot(ToothGrowth)
with(ToothGrowth, plot(supp, len))

vc <- ToothGrowth[ToothGrowth$supp=="VC",]
oj <- ToothGrowth[ToothGrowth$supp=="OJ",]

#plot(oj, col=oj$dose)
#plot(oj, col=oj$supp)
#plot(oj, col=oj$len)

boxplot(len ~ supp * dose, data=ToothGrowth, ylab="Tooth Length", main="Boxplots of Tooth Growth Data")

require(graphics)
coplot(len ~ dose | supp, data = ToothGrowth, panel = panel.smooth)

library(ggplot2)

ggplot(ToothGrowth, aes(x = supp, y = len, fill = supp)) + geom_boxplot() + facet_wrap(~ dose)
ggplot(ToothGrowth, aes(x = factor(dose), y = len, fill = factor(dose))) + geom_boxplot() + facet_grid(~ supp)

ggplot(ToothGrowth, aes(x = supp, y = len)) + geom_boxplot()
ggplot(ToothGrowth, aes(x = supp, y = len, fill = supp)) + geom_boxplot()
ggplot(ToothGrowth, aes(factor(dose), len)) + geom_boxplot() + facet_grid(.~supp)
ggplot(ToothGrowth, aes(factor(dose), len, fill = dose)) + geom_boxplot() + facet_grid(.~supp)

qplot(len, dose, data = ToothGrowth)

library(lattice)
xyplot(len ~ dose | supp, data = ToothGrowth)
xyplot(len ~ supp | dose, data = ToothGrowth, layout = c(3,1))
```

Plot like the chickweight
```{r}
library(reshape2); library(ggplot2)

g <- ggplot(ToothGrowth, aes(x = factor(supp), y = len, fill = factor(dose)))
g <- g + geom_violin(col = "black", size = 2)
g

g <- ggplot(ToothGrowth, aes(x = factor(dose), y = len, fill = factor(supp)))
g <- g + geom_violin(col = "black", size = 2)
g

g <- ggplot(ToothGrowth, aes(x = dose, y = len, colour = supp, group = supp))
g <- g + geom_line()
g <- g + stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1, col = "black")
g <- g + facet_grid(. ~ supp)
g

g <- ggplot(ToothGrowth, aes(x = supp, y = len, colour = dose, group = dose))
g <- g + geom_line()
g <- g + stat_summary(aes(group = 1), geom = "line", fun.y = mean, size = 1, col = "black")
g <- g + facet_grid(. ~ dose)
g
```

And some other stuff

```{r}
#ggplot (ToothGrowth, aes (x = dose, y = len, fill = supp)) + stat_binhex (bins=5, aes (alpha = ..count..)) + facet_grid (. ~ Species)

xyplot(len ~ supp, ToothGrowth, groups = ToothGrowth$dose, pch= 20)

```

# Techo
```{r}
sessionInfo()
```

